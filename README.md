# Protocol Buffer Compiler and Runtime for Nim


## Source Tree Layout

`protobuf.nim` is a runtime library supporting serialization and deserialization
functionality for protobuf code generated by the Protocol Buffer Compiler
(`protoc`).  `protoc_plugin.nim` is a plugin for that compiler, generating the
corresponding serialization and deserialization code for specific `.proto`
protobuf definition files.

`generated_code/` contains generated code for the protobuf messages used by
`protoc` to communicate with its plugins.  This code is required to build the
plugin, but was also built by the plugin.  (The first cut of this code was
actually built by a quick and dirty plugin written in Go, which already had an
existing `protoc` plugin available.)

## Building the Plugin

To compile the plugin using the saved generated code:

```
nim c \
  --path:"$PWD/generated_code" \
  --path:"$PWD" \
  protoc_plugin.nim
```

## Running the Plugin

Then, you can use the plugin to generate code for other `.proto` files with
something like this command, which builds the `protoc` plugin API definitions:

```
protoc \
  --plugin=protoc-gen-custom="$PWD/protoc_plugin" \
  --custom_out="$PWD/generated_code" \
  /usr/include/google/protobuf/descriptor.proto \
  /usr/include/google/protobuf/compiler/plugin.proto
```

Incidentally, this is precisely how `generated_code` was built.

Change the parameters to use your own `.proto` files.


## Using the Results

The `examples/` directory has a number of examples showing how you
might use the results of compilation, including an extremely simplistic
(and highly insecure) remote procedure call implementation.

## Current Status and Future Work

This project barely qualifies as alpha, as it has:

* No good RPC implementation
* No tests
* No guarantees of interface stability
* No packaging
* No release process

The above is a reasonable list of things to fix before it could be
considered a beta.
